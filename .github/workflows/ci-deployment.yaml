name: ADF Release pipeline

on:
  workflow_dispatch:
    inputs:
      Environment:
        type: environment
        description: Select the Environment for ADF deployment
        required: true
      Location:
        type: choice
        description: Select the location for ADF deployment
        required: false
        default: 'East US 2'
        options: 
        - East US 2
        - East US
      DryRun:
        type: boolean
        description: Select to run Dry Run or preview ADF deployment

run-name: Deploy to ${{ inputs.Environment }} by @${{ github.actor }}

permissions:
  id-token: write
  contents: read
  
jobs:
  Deploy-ADF-Dev:
    runs-on: windows-latest
    environment: ${{ inputs.Environment }}

    steps:
    - name: Checkout Code
      uses: actions/checkout@v3
   
    - name: Delete unwanted integration runtime
      run: |
          git clone --branch master --single-branch https://github.com/microsoft/azure-pipelines-tasks.git
          cd azure-pipelines-tasks/Tasks/WindowsMachineFileCopyV2
          ./WindowsMachineFileCopy.ps1
